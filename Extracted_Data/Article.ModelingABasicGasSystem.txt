Header: Article: Modelling a basic gas system in PLEXOS

Table Details:
	Metric	Imperial U.S.
Gas volume and flow	Terajoule (TJ)	Million British Thermal Unit (MMBTU)
Gas pricing	$/Gigajoule ($/GJ)	$/Million British Thermal Unit ($/MMBTU)

Paragraphs:
Introduction Prerequisites Overview of the PLEXOS Interface Starting a New Study Updating Units of Data Settings Using Config to add or remove classes and properties Enabling the Gas Zone Enabling Max Daily Take Enabling All Dynamic Mode Creating New Objects Exercise: Create the following objects Defining Properties for an Object Exercise: Add properties to the gas system objects Creating and Using a Data File Creating a Data File in Excel Creating the Data File in PLEXOS Using the data file in PLEXOS Defining Memberships Between Objects Creating Pipeline Memberships Exercise: Define memberships between objects Using the Visualizer Setting Up and Running a Simulation Setting Up a Simulation Setting the Planning Horizon Configuring Reports Running a Simulation Viewing the Simulation Solution Opening the Simulation Solution Viewing Reports Calculating Weighted Average Cost of Gas (WACOG)

1. Introduction This article is for users who have gas modelling industry knowledge but who are new to PLEXOS. You'll learn how to set up a basic gas system using the following objects and their associated memberships and properties: Gas Demand Gas Node Gas Pipeline Gas Storage Gas Contract Gas Zone This article also covers how to run a simple ST simulation and to review the Weighted Average Cost of Gas (WACOG) in simulation results. 2. Prerequisites To model a basic gas system in PLEXOS, you will need to have PLEXOS version 8.2 or later installed on your computer. Before setting up your gas system in PLEXOS, you may want to have a data file in .csv format saved in a known location on your computer. In the Creating and Using a Data File section, you will see how to create this file and then link properties to this file so you don't have to manually enter values. 3. Overview of the PLEXOS Interface There are seven main sections of the PLEXOS interface: The Ribbon : Contains actions for setting up systems, running simulations, and adjusting settings. The Main Tree : Contains the System and Simulation tabs: The tree under the System tab shows the Objects in the database organized into Collections according to the object class (type of object). List Tree : Used to create lists of objects. Membership Tree : This tree displays all relationships between objects. Properties Tree : This tree lists the properties available for the class of objects selected in the Main Tree. Data Pane : This consists of three grids: Objects, Memberships and Properties. History Pane : This consists of two lists: Saved and recent items. 4. Starting a New Study Open PLEXOS for desktop. On the Home tab, in the upper left of the screen, click New . Select Natural Gas and then click OK . Your new project opens with basic gas objects available in the main tree. If needed, you can enable more gas object classes from the Config menu. 5. Updating Units of Data Settings By default, a new gas project is set to use the metric system. For gas modelling in the United States, you can set units to the Imperial U.S. system. Metric Imperial U.S. Gas volume and flow Terajoule (TJ) Million British Thermal Unit (MMBTU) Gas pricing $/Gigajoule ($/GJ) $/Million British Thermal Unit ($/MMBTU) To change units of data to Imperial, On the Home tab in PLEXOS, click Settings on the far right of the ribbon. On the bottom left of the Units of Data tab, choose Imperial . Click OK when you're done. This will set how units of data are represented throughout PLEXOS. 6. Using Config to add or remove classes and properties When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

This article is for users who have gas modelling industry knowledge but who are new to PLEXOS. You'll learn how to set up a basic gas system using the following objects and their associated memberships and properties: Gas Demand Gas Node Gas Pipeline Gas Storage Gas Contract Gas Zone This article also covers how to run a simple ST simulation and to review the Weighted Average Cost of Gas (WACOG) in simulation results. 2. Prerequisites To model a basic gas system in PLEXOS, you will need to have PLEXOS version 8.2 or later installed on your computer. Before setting up your gas system in PLEXOS, you may want to have a data file in .csv format saved in a known location on your computer. In the Creating and Using a Data File section, you will see how to create this file and then link properties to this file so you don't have to manually enter values. 3. Overview of the PLEXOS Interface There are seven main sections of the PLEXOS interface: The Ribbon : Contains actions for setting up systems, running simulations, and adjusting settings. The Main Tree : Contains the System and Simulation tabs: The tree under the System tab shows the Objects in the database organized into Collections according to the object class (type of object). List Tree : Used to create lists of objects. Membership Tree : This tree displays all relationships between objects. Properties Tree : This tree lists the properties available for the class of objects selected in the Main Tree. Data Pane : This consists of three grids: Objects, Memberships and Properties. History Pane : This consists of two lists: Saved and recent items. 4. Starting a New Study Open PLEXOS for desktop. On the Home tab, in the upper left of the screen, click New . Select Natural Gas and then click OK . Your new project opens with basic gas objects available in the main tree. If needed, you can enable more gas object classes from the Config menu. 5. Updating Units of Data Settings By default, a new gas project is set to use the metric system. For gas modelling in the United States, you can set units to the Imperial U.S. system. Metric Imperial U.S. Gas volume and flow Terajoule (TJ) Million British Thermal Unit (MMBTU) Gas pricing $/Gigajoule ($/GJ) $/Million British Thermal Unit ($/MMBTU) To change units of data to Imperial, On the Home tab in PLEXOS, click Settings on the far right of the ribbon. On the bottom left of the Units of Data tab, choose Imperial . Click OK when you're done. This will set how units of data are represented throughout PLEXOS. 6. Using Config to add or remove classes and properties When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

This article is for users who have gas modelling industry knowledge but who are new to PLEXOS. You'll learn how to set up a basic gas system using the following objects and their associated memberships and properties:

This article also covers how to run a simple ST simulation and to review the Weighted Average Cost of Gas (WACOG) in simulation results.

2. Prerequisites To model a basic gas system in PLEXOS, you will need to have PLEXOS version 8.2 or later installed on your computer. Before setting up your gas system in PLEXOS, you may want to have a data file in .csv format saved in a known location on your computer. In the Creating and Using a Data File section, you will see how to create this file and then link properties to this file so you don't have to manually enter values. 3. Overview of the PLEXOS Interface There are seven main sections of the PLEXOS interface: The Ribbon : Contains actions for setting up systems, running simulations, and adjusting settings. The Main Tree : Contains the System and Simulation tabs: The tree under the System tab shows the Objects in the database organized into Collections according to the object class (type of object). List Tree : Used to create lists of objects. Membership Tree : This tree displays all relationships between objects. Properties Tree : This tree lists the properties available for the class of objects selected in the Main Tree. Data Pane : This consists of three grids: Objects, Memberships and Properties. History Pane : This consists of two lists: Saved and recent items. 4. Starting a New Study Open PLEXOS for desktop. On the Home tab, in the upper left of the screen, click New . Select Natural Gas and then click OK . Your new project opens with basic gas objects available in the main tree. If needed, you can enable more gas object classes from the Config menu. 5. Updating Units of Data Settings By default, a new gas project is set to use the metric system. For gas modelling in the United States, you can set units to the Imperial U.S. system. Metric Imperial U.S. Gas volume and flow Terajoule (TJ) Million British Thermal Unit (MMBTU) Gas pricing $/Gigajoule ($/GJ) $/Million British Thermal Unit ($/MMBTU) To change units of data to Imperial, On the Home tab in PLEXOS, click Settings on the far right of the ribbon. On the bottom left of the Units of Data tab, choose Imperial . Click OK when you're done. This will set how units of data are represented throughout PLEXOS. 6. Using Config to add or remove classes and properties When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To model a basic gas system in PLEXOS, you will need to have PLEXOS version 8.2 or later installed on your computer. Before setting up your gas system in PLEXOS, you may want to have a data file in .csv format saved in a known location on your computer. In the Creating and Using a Data File section, you will see how to create this file and then link properties to this file so you don't have to manually enter values. 3. Overview of the PLEXOS Interface There are seven main sections of the PLEXOS interface: The Ribbon : Contains actions for setting up systems, running simulations, and adjusting settings. The Main Tree : Contains the System and Simulation tabs: The tree under the System tab shows the Objects in the database organized into Collections according to the object class (type of object). List Tree : Used to create lists of objects. Membership Tree : This tree displays all relationships between objects. Properties Tree : This tree lists the properties available for the class of objects selected in the Main Tree. Data Pane : This consists of three grids: Objects, Memberships and Properties. History Pane : This consists of two lists: Saved and recent items. 4. Starting a New Study Open PLEXOS for desktop. On the Home tab, in the upper left of the screen, click New . Select Natural Gas and then click OK . Your new project opens with basic gas objects available in the main tree. If needed, you can enable more gas object classes from the Config menu. 5. Updating Units of Data Settings By default, a new gas project is set to use the metric system. For gas modelling in the United States, you can set units to the Imperial U.S. system. Metric Imperial U.S. Gas volume and flow Terajoule (TJ) Million British Thermal Unit (MMBTU) Gas pricing $/Gigajoule ($/GJ) $/Million British Thermal Unit ($/MMBTU) To change units of data to Imperial, On the Home tab in PLEXOS, click Settings on the far right of the ribbon. On the bottom left of the Units of Data tab, choose Imperial . Click OK when you're done. This will set how units of data are represented throughout PLEXOS. 6. Using Config to add or remove classes and properties When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To model a basic gas system in PLEXOS, you will need to have PLEXOS version 8.2 or later installed on your computer.

Before setting up your gas system in PLEXOS, you may want to have a data file in .csv format saved in a known location on your computer. In the Creating and Using a Data File section, you will see how to create this file and then link properties to this file so you don't have to manually enter values.

3. Overview of the PLEXOS Interface There are seven main sections of the PLEXOS interface: The Ribbon : Contains actions for setting up systems, running simulations, and adjusting settings. The Main Tree : Contains the System and Simulation tabs: The tree under the System tab shows the Objects in the database organized into Collections according to the object class (type of object). List Tree : Used to create lists of objects. Membership Tree : This tree displays all relationships between objects. Properties Tree : This tree lists the properties available for the class of objects selected in the Main Tree. Data Pane : This consists of three grids: Objects, Memberships and Properties. History Pane : This consists of two lists: Saved and recent items. 4. Starting a New Study Open PLEXOS for desktop. On the Home tab, in the upper left of the screen, click New . Select Natural Gas and then click OK . Your new project opens with basic gas objects available in the main tree. If needed, you can enable more gas object classes from the Config menu. 5. Updating Units of Data Settings By default, a new gas project is set to use the metric system. For gas modelling in the United States, you can set units to the Imperial U.S. system. Metric Imperial U.S. Gas volume and flow Terajoule (TJ) Million British Thermal Unit (MMBTU) Gas pricing $/Gigajoule ($/GJ) $/Million British Thermal Unit ($/MMBTU) To change units of data to Imperial, On the Home tab in PLEXOS, click Settings on the far right of the ribbon. On the bottom left of the Units of Data tab, choose Imperial . Click OK when you're done. This will set how units of data are represented throughout PLEXOS. 6. Using Config to add or remove classes and properties When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

There are seven main sections of the PLEXOS interface: The Ribbon : Contains actions for setting up systems, running simulations, and adjusting settings. The Main Tree : Contains the System and Simulation tabs: The tree under the System tab shows the Objects in the database organized into Collections according to the object class (type of object). List Tree : Used to create lists of objects. Membership Tree : This tree displays all relationships between objects. Properties Tree : This tree lists the properties available for the class of objects selected in the Main Tree. Data Pane : This consists of three grids: Objects, Memberships and Properties. History Pane : This consists of two lists: Saved and recent items. 4. Starting a New Study Open PLEXOS for desktop. On the Home tab, in the upper left of the screen, click New . Select Natural Gas and then click OK . Your new project opens with basic gas objects available in the main tree. If needed, you can enable more gas object classes from the Config menu. 5. Updating Units of Data Settings By default, a new gas project is set to use the metric system. For gas modelling in the United States, you can set units to the Imperial U.S. system. Metric Imperial U.S. Gas volume and flow Terajoule (TJ) Million British Thermal Unit (MMBTU) Gas pricing $/Gigajoule ($/GJ) $/Million British Thermal Unit ($/MMBTU) To change units of data to Imperial, On the Home tab in PLEXOS, click Settings on the far right of the ribbon. On the bottom left of the Units of Data tab, choose Imperial . Click OK when you're done. This will set how units of data are represented throughout PLEXOS. 6. Using Config to add or remove classes and properties When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

There are seven main sections of the PLEXOS interface:

4. Starting a New Study Open PLEXOS for desktop. On the Home tab, in the upper left of the screen, click New . Select Natural Gas and then click OK . Your new project opens with basic gas objects available in the main tree. If needed, you can enable more gas object classes from the Config menu. 5. Updating Units of Data Settings By default, a new gas project is set to use the metric system. For gas modelling in the United States, you can set units to the Imperial U.S. system. Metric Imperial U.S. Gas volume and flow Terajoule (TJ) Million British Thermal Unit (MMBTU) Gas pricing $/Gigajoule ($/GJ) $/Million British Thermal Unit ($/MMBTU) To change units of data to Imperial, On the Home tab in PLEXOS, click Settings on the far right of the ribbon. On the bottom left of the Units of Data tab, choose Imperial . Click OK when you're done. This will set how units of data are represented throughout PLEXOS. 6. Using Config to add or remove classes and properties When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

Open PLEXOS for desktop. On the Home tab, in the upper left of the screen, click New . Select Natural Gas and then click OK . Your new project opens with basic gas objects available in the main tree. If needed, you can enable more gas object classes from the Config menu. 5. Updating Units of Data Settings By default, a new gas project is set to use the metric system. For gas modelling in the United States, you can set units to the Imperial U.S. system. Metric Imperial U.S. Gas volume and flow Terajoule (TJ) Million British Thermal Unit (MMBTU) Gas pricing $/Gigajoule ($/GJ) $/Million British Thermal Unit ($/MMBTU) To change units of data to Imperial, On the Home tab in PLEXOS, click Settings on the far right of the ribbon. On the bottom left of the Units of Data tab, choose Imperial . Click OK when you're done. This will set how units of data are represented throughout PLEXOS. 6. Using Config to add or remove classes and properties When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.



Your new project opens with basic gas objects available in the main tree. If needed, you can enable more gas object classes from the Config menu.

5. Updating Units of Data Settings By default, a new gas project is set to use the metric system. For gas modelling in the United States, you can set units to the Imperial U.S. system. Metric Imperial U.S. Gas volume and flow Terajoule (TJ) Million British Thermal Unit (MMBTU) Gas pricing $/Gigajoule ($/GJ) $/Million British Thermal Unit ($/MMBTU) To change units of data to Imperial, On the Home tab in PLEXOS, click Settings on the far right of the ribbon. On the bottom left of the Units of Data tab, choose Imperial . Click OK when you're done. This will set how units of data are represented throughout PLEXOS. 6. Using Config to add or remove classes and properties When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

By default, a new gas project is set to use the metric system. For gas modelling in the United States, you can set units to the Imperial U.S. system. Metric Imperial U.S. Gas volume and flow Terajoule (TJ) Million British Thermal Unit (MMBTU) Gas pricing $/Gigajoule ($/GJ) $/Million British Thermal Unit ($/MMBTU) To change units of data to Imperial, On the Home tab in PLEXOS, click Settings on the far right of the ribbon. On the bottom left of the Units of Data tab, choose Imperial . Click OK when you're done. This will set how units of data are represented throughout PLEXOS. 6. Using Config to add or remove classes and properties When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

By default, a new gas project is set to use the metric system. For gas modelling in the United States, you can set units to the Imperial U.S. system.

To change units of data to Imperial,

This will set how units of data are represented throughout PLEXOS.

6. Using Config to add or remove classes and properties When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree: Gas Fields Gas Pipelines Gas Nodes Gas Storages Gas Demands Gas Contracts For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract. 6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

When you start a new gas study in PLEXOS, by default you will have the following classes enabled in the main tree:

For this article, you will need to enable the Gas Zone class and the Max Daily take property for the Gas contract.

6.1. Enabling the Gas Zone On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

On the Home tab, click Config on the far right of the ribbon. Tick the box next to Gas Zone in the pane on the left. 6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.



6.2. Enabling Quantity Day Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

Still in Config settings, expand Gas Contract and go to Gas Contracts >> Production . Check the box to enable Quantity . The property will appear under the Gas Contracts category in the pane on the right, which lists all enabled classes and properties. Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode. 7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.



Quantity Day is a dynamic property, meaning it its value can be changed by other variables in the simulation. Instead of manually enabling each dynamic property, you can enable All Dynamic mode.

7. Enabling All Dynamic Mode All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

All Dynamic mode enables all dynamic properties. In Config settings, toggle the entire database to All Dynamic mode by ticking the box in the bottom-left corner. Click OK when you are done. To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed. You can learn more about Config in the Configuration article. 8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

All Dynamic mode enables all dynamic properties.

To set up a more complex system than the one in this article, you would use the Config menu to add classes and their associated objects and properties as needed.

You can learn more about Config in the Configuration article.

8. Creating New Objects To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc. Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS . This section uses the example of adding a new gas node to the system. The process is the same for adding any other object. To create a new gas node, In the main tree, right-click on Gas Nodes and then select New Gas Node... In the New Gas Node window, enter a Name for the gas node. Click OK . The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object. Click OK in the lower right of the window. You will add memberships in another step. 8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To begin setting up your gas system, you will first need to create gas objects such as nodes, demands, shortages, etc.

Note : There are multiple ways to create new objects in PLEXOS, this example shows one way to do so. For more information about creating objects, please read the article, Entering Data in PLEXOS .

This section uses the example of adding a new gas node to the system. The process is the same for adding any other object.

To create a new gas node,

8.1. Exercise: Create the following objects To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To setup a basic gas system for this exercise, create the following objects and name them as shown: 2 Gas Demands : Demand 1, Demand 2 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3 1 Gas Storage : Gas Storage 1 2 Gas Contracts : Gas Contract 1, Gas Contract 2 1 Gas Zone : Gas Zone 1 Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy . 9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To setup a basic gas system for this exercise, create the following objects and name them as shown:

Tip : To save time, if you will have multiple of the same object, create the first object and | set its properties]]. Then, duplicate and adjust properties for the new objects as needed. To duplicate an object, right-click on the object in the main tree and then select Copy .

9. Defining Properties for an Object After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

After creating an object, select it in the main tree. In the data pane on the right, select the Properties tab. In the lower panel on the Properties tab, double-click in the first empty cell of the Property column. Use the drop-down menu to select which property to include. Manually enter the value in the Value column or include a path to a data file in the Data File column. To see how to include a path to data file, read the Creating and Using a Data File section of this article. Repeat steps 3-5 for each property you need to set for this object. If you do not see a property you need to add, check the Config settings . 9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.



9.1. Exercise: Add properties to the gas system objects Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object. Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section. 9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

Use the following table to add properties to the gas objects. The Child Object column lists the object name, and the Property column lists the properties for that object.

Note : In the above table, for Gas Demands 1 and 2, the Value field is empty. Instead, there is a data file called Gas Demand listed in the Data File column. You will see how to set up data files in the Creating and Using a Data File section.

9.2. Creating and Using a Data File Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable. 9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

Instead of manually entering values one by one, you can reference files that contain the data for your system's object properties. For example, after you have created your Gas Demand objects, you can use an Excel spreadsheet to list daily values for each Gas Demand object. PLEXOS references the file and includes the appropriate values where applicable.

9.2.1. Creating a Data File in Excel For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

For this example, create a data file for the Gas Demand objects. Open Microsoft Excel, or an application that can save a .csv file. In a new spreadsheet, name the first column DATETIME by typing in cell A1. Name the next two columns the same name as the objects: Gas Demand 1 and Gas Demand 2. In the DATETIME column, list the date for each day of the study period. In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format. Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period. Enter the appropriate data in the remaining cells. Since you are entering data for the Gas Demands, enter the demand for each day of the study period. Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2. Save the file in .csv format. You will need to know the path to the file to use the data file in PLEXOS. Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki. 9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

For this example, create a data file for the Gas Demand objects.

Note : How you set up a data file will vary depending on object you are creating it for. For more detailed information about data files, read the Data Files section of the PLEXOS Wiki.

9.2.2. Creating the Data File in PLEXOS From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

From the main tree in PLEXOS, under Data, right click on Data Files and select New Data File... In the New Data File window, name the data file "Gas Demand" and click OK . Click OK in the common object properties window. In the main tree under Data >> Data Files , select the new data file. In the data pane on the right, select the Properties tab. In the lower pane of the Properties tab, double-click into the first empty cell under the Property column, and then choose Filename . In the lower pane of the Properties tab, double-click into the first empty cell under the Filename column, type (or paste) the path to the file you created and saved in the Creating a Data File in Excel section. The path should look like this: "C:\ FolderName \ FileName .csv." 9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.



9.2.3. Using the data file in PLEXOS In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

In the main tree, select Gas Demand 1 . In the data pane, Select the Properties tab. In the lower pane of the Properties tab, locate the Demand property. Under the Data File column, double-click into the cell that corresponds with the Demand property and select the name of the Data File. Repeat steps for 1 - 4 for Gas Demand 2. Your system will now pull values for that property from the data file. 10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.



10. Defining Memberships Between Objects To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To create memberships between objects: In the main tree, click and drag one object onto another. For this example, drag Gas Storage 1 onto Gas Node 2 . In the membership tree, you will see the new membership you created and any other memberships the selected object has. Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name]. 10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To create memberships between objects:

10.1. Creating Pipeline Memberships In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline: In the main tree, select Pipeline 1_2. In the membership tree, notice there are two gas node membership options: Gas Node From and Gas Node To . While Pipeline 1_2 is still selected, click on Gas Node 1 from the main tree and drag it to Gas Node From in the membership tree. To create the Gas Node To membership, with Pipeline 1_2 still selected, click on Gas Node 2 from the main tree and drag it to Gas Node To in the membership tree. When done, the membership tree for Pipeline 1_2 will look like this: 10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

In some cases, you may need to drag an object from the main tree, onto the membership tree. For example, a gas pipeline must connect to two nodes. To connect nodes to a gas pipeline:

10.2. Exercise: Define memberships between objects To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To complete initial set up of this basic gas model, create the following memberships: Pipeline 1_2 : Flows from Node 1 to Node 2 Pipeline 2_3 : Flows from Node 2 to Node 3 Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1 Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2 Gas Node 3 : Connects to Pipeline 2_3, and Contract 2 Gas Storage 1 : Connects to Node 2 Gas Demand 1 : Connects to Node 1 Gas Demand 2 : Connects to Node 2 Gas Contract 1 : Connects to Node 1 Gas Contract 2 : Connects to Node 3 Gas Zone 1 : Includes all three Gas Nodes 11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To complete initial set up of this basic gas model, create the following memberships:

11. Using the Visualizer After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer. In PLEXOS, click the Visualizer tab above the ribbon, then choose Graph . In the pane on the left, select which objects you would like to see in the visualizer by ticking the boxes next to the object name. To see all objects, tick the box on main folder. Right-click on the main window and the drag your cursor to move the visible area of the workspace. Left-click and drag each object to move it. Do this for each object and arrange your system as needed. You can use the mouse wheel to zoom in or out. In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box. In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object. Click Close in the lower right of the screen when you are done visualizing the model. 12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

After you have created objects and their memberships, you can see a visual representation of your gas system using the visualizer.

12. Setting Up and Running a Simulation To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes. 12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

To run a simulation using the gas system you have created, make sure all objects, memberships, and properties are set up accurately. However, if you find errors in your simulation results, you can return to the system and make changes.

12.1. Setting Up a Simulation This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS. 12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

This simulation example uses an ST schedule called Regional that is a default option when you create a new natural gas file in PLEXOS.

12.1.1. Setting the Planning Horizon In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

In the main tree of PLEXOS, select the Simulation tab. In the main tree, expand the Execute folder, then expand the Models folder. Select Regional . In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder. In Simulation tab of the main tree, under Execute >> Models , double-click Regional to open simulation settings. Select the Horizon tab. In the Planning Horizon section, set the Begin On date , and how long the simulation should Run for . The End On option will update automatically. Set Interval Length , Days Begin , Years End , and Weeks Begin . For more detailed information, read the Simulation article . In the ST schedule section, click Synchronize to Planning Horizon . This will match the ST Schedule settings to your Planning Horizon settings. 12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.



12.1.2. Configuring Reports Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output. Still in simulation settings, select the Report tab and then click Report Fields . Expand Gas Zone and then expand Production . Tick the box to select Weighted Average Cost . Verify that Demand and Net Variable Cost are also selected. These outputs are required to successfully calculate Weighted Average Cost. Click OK . 12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

Before running a simulation, it is a good practice to verify that reports are set up to meet your needs. For this example, we will enable the Weighted Average Cost output.

12.2. Running a Simulation Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

Before running a simulation, make sure you save any changes to the system. When you have finished setting up the simulation, in the main tree of PLEXOS right click on the model and select Execute . Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon. In the Execute Order window, verify that your model is added to the Models and Projects selected for next Execution area. In the bottom right of the window, click Execute . When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS. The solution file will be saved to the same location you saved the study when you first created it. 13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

Before running a simulation, make sure you save any changes to the system.

13. Viewing the Simulation Solution 13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.



13.1. Opening the Simulation Solution When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

When the simulation has completed, return to PLEXOS. In the main tree under the Simulation tab, under Execute >> Models , right-click on the model and select Open Solution . The solution window opens in a new tab. 13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.



13.2. Viewing Reports The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right. Click on an object in the Object Tree Panel to select it. The Parameter Panel will list available parameters to report on for that object. Select a property in the Properties section of the Parameter Panel. Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow. To see results, click Execute in the ribbon. Results will appear in the Result Panel. To view a chart of the results, in the Result Panel, select the Chart tab. 14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

The solution window consists of three areas: The Parameter Panel on the left, the Object Tree Panel in the middle, and the Result Panel on the right.

14. Calculating Weighted Average Cost of Gas (WACOG) Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.

Set up and run the simulation . Open the simulation solution . Select Gas Zone from the Object Tree Panel. Select Weighted Average Cost in the Parameter Panel. Click Execute in the ribbon.


Lists:
	- Gas Demand
	- Gas Node
	- Gas Pipeline
	- Gas Storage
	- Gas Contract
	- Gas Zone
	- The Ribbon : Contains actions for setting up systems, running simulations, and adjusting settings.
	- The Main Tree : Contains the System and Simulation tabs: The tree under the System tab shows the Objects in the database organized into Collections according to the object class (type of object).
	- List Tree : Used to create lists of objects.
	- Membership Tree : This tree displays all relationships between objects.
	- Properties Tree : This tree lists the properties available for the class of objects selected in the Main Tree.
	- Data Pane : This consists of three grids: Objects, Memberships and Properties.
	- History Pane : This consists of two lists: Saved and recent items.
	- Gas Fields
	- Gas Pipelines
	- Gas Nodes
	- Gas Storages
	- Gas Demands
	- Gas Contracts
	- The object will be created in the database and the common object properties window will appear. This window lists all the memberships and properties associated with the new object.
	- 2 Gas Demands : Demand 1, Demand 2
	- 3 Gas Nodes : Gas Node 1, Gas Node 2, Gas Node 3
	- 2 Gas Pipelines : Pipeline 1_2, Pipeline 2_3
	- 1 Gas Storage : Gas Storage 1
	- 2 Gas Contracts : Gas Contract 1, Gas Contract 2
	- 1 Gas Zone : Gas Zone 1
	- To see how to include a path to data file, read the Creating and Using a Data File section of this article.
	- If you do not see a property you need to add, check the Config settings .
	- In the first cell (A2) of the DATETIME column, enter the first day of the simulation period using the MM/DD/YYYY format.
	- Make sure the first cell is highlighted. Click the bottom right corner of the cell and drag down over enough cells to cover the number of days in the study period.
	- Tip : For this exercise, use the RANDBETWEEN() formula in Excel to quickly generate demand values for each day. In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200. To copy the formula for each day in the study, double-click the bottom right corner cell B2. Repeat this for Gas Demand 2.
	- In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200.
	- To copy the formula for each day in the study, double-click the bottom right corner cell B2.
	- Repeat this for Gas Demand 2.
	- In cell B2 as shown above, type "=RANDBETWEEN(100, 200)" and hit enter. This will create a random number between 100 and 200.
	- To copy the formula for each day in the study, double-click the bottom right corner cell B2.
	- Repeat this for Gas Demand 2.
	- The path should look like this: "C:\ FolderName \ FileName .csv."
	- Your system will now pull values for that property from the data file.
	- Note : You can also create new objects directly in the memberships tree. This will create the new object and a membership at the same time. To do so, right click on a membership type in the membership tree, then click New [object name].
	- When done, the membership tree for Pipeline 1_2 will look like this:
	- Pipeline 1_2 : Flows from Node 1 to Node 2
	- Pipeline 2_3 : Flows from Node 2 to Node 3
	- Gas Node 1 : Connects to Pipeline 1_2, Demand 1, and Contract 1
	- Gas Node 2 : Connects to Pipeline 1_2, Pipeline 2_3, Storage 1, and Demand 2
	- Gas Node 3 : Connects to Pipeline 2_3, and Contract 2
	- Gas Storage 1 : Connects to Node 2
	- Gas Demand 1 : Connects to Node 1
	- Gas Demand 2 : Connects to Node 2
	- Gas Contract 1 : Connects to Node 1
	- Gas Contract 2 : Connects to Node 3
	- Gas Zone 1 : Includes all three Gas Nodes
	- You can use the mouse wheel to zoom in or out.
	- In the lower right corner of the screen, you'll see what area of the workspace you are viewing represented by a blue box.
	- In the ribbon, with the Visualizer tab selected, you'll see various options. You can use these options to change how the visualizer workspace functions. When an individual object is selected, Object Options appear that are specific to that object.
	- In the membership tree, you will see the types of simulations that will be run with this model when you execute it. For this example, we only want to run an ST schedule. So, in the membership tree under both the PASA and MT Schedule folders, right click on Regional and select Delete . Now there should only be one model called Regional under the ST Schedule folder.
	- For more detailed information, read the Simulation article .
	- Note : You can also execute a simulation by clicking Execute from the simulation settings window, or by clicking Execute from the Home tab of the ribbon.
	- When you execute a simulation, a new window appears that shows the progress of the simulation. When the simulation has completed, you can press any key to close the window and continue in PLEXOS.
	- The solution file will be saved to the same location you saved the study when you first created it.
	- Note : To select more than one property, hold Shift (or Ctrl) and click on additional properties. Selected properties are highlighted yellow.


H2s:
6.1. Enabling the Gas Zone
6.2. Enabling Quantity Day
8.1. Exercise: Create the following objects
9.1. Exercise: Add properties to the gas system objects
9.2.Creating and Using a Data File
10.1. Creating Pipeline Memberships
10.2. Exercise: Define memberships between objects
12.1.Setting Up a Simulation
12.2.Running a Simulation
13.1.Opening the Simulation Solution
13.2. Viewing Reports

H3s:
9.2.1.Creating a Data File in Excel
9.2.2. Creating the Data File in PLEXOS
9.2.3. Using the data file in PLEXOS
12.1.1. Setting the Planning Horizon
12.1.2. Configuring Reports
